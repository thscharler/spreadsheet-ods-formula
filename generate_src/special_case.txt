6.14.4 GETPIVOTDATA
6.14.4.1 General

Summary: Return a value from a data pilot table.

Note: This function has two syntaxes. The first of these is the preferred syntax, while the second, alternative syntax is provided for compatibility reasons.
6.14.4.2 Preferred Syntax

Syntax: GETPIVOTDATA( Text DataField ; Reference Table { ; Text FieldName ; Scalar Member }* )

Note: This version of the syntax is distinguished by the parameter Table being the second parameter.

Returns: Any

Semantics: Returns a single result from the calculation of a data pilot table.

The data pilot table is selected by Table, which is a reference to a cell or cell range that's within a data pilot table or contains a data pilot table. If the cell range contains several data pilot tables, the last one in the order of <table:data-pilot-table> elements (OpenDocument, Part 3, 9.6.3) in the file is used.

DataField selects one of the data pilot table's data fields. It can be the name of the source column, or the given name of the data field (such as “Sum of Sales”).

If no FieldName/Member pairs are given, the grand total is returned. Otherwise, each pair adds a constraint that the result shall satisfy. FieldName is the name of a field from the data pilot table. Member is the name of a member (item) from that field. If a member is a number, Member can alternatively be its numerical value.

If the data pilot table contains only a single result value that fulfills all of the constraints, or a subtotal result that summarizes all matching values, that result is returned. If there is no matching result, or several ones without a subtotal for them, an Error is returned. These conditions apply to results that are included in the data pilot table. If the source data contains entries that are hidden by settings of the data pilot table, they are ignored. The order of the FieldName/Member pairs is not significant. Field and member names are case-insensitive.

If no constraint for a page field is given, the field's selected value is implicitly used. If a constraint for a page field is given, it shall match the field's selected value, or an Error is returned.

Subtotal values from the data pilot table are only used if they use the function “auto” (except when specified in the constraint, see below).
6.14.4.3 Alternative Syntax

Syntax: GETPIVOTDATA( Reference Table ; Text Constraints )

Note: This version of the syntax is distinguished by the parameter Table being the first parameter.

Returns: Any

Semantics: Returns a single result from the calculation of a data pilot table.

Table has the same meaning as in the preferred syntax.

Constraints is a space-separated list. Entries can be quoted (single quotes). One of the entries can be the data field name. The data field name can be left out if the data pilot table contains only one data field, otherwise it shall be present. Each of the other entries specifies a constraint in the form FieldName[Member] (with literal characters “[“ (LEFT SQUARE BRACKET, U+005B) and “]” (RIGHT SQUARE BRACKET U+005D)), or only Member if the member name is unique within all fields that are used in the data pilot table. A function name can be added in the form FieldName[Member;Function], which will cause the constraint to match only subtotal values which use that function. The possible function names are the same as in the table:function attribute of the <table:data-pilot-subtotal> element (OpenDocument, Part 3, 19.647.4), case-insensitive.